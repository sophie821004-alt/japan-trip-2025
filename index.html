<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SL Japan Travel 2025</title>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <style>
        /* åŸºç¤æ¨£å¼å’Œå­—é«” */
        body { 
            font-family: 'Noto Sans JP', sans-serif; 
            background-color: #FBF9F2; 
            transition: background-color 0.5s;
            -webkit-tap-highlight-color: transparent; 
        }
        /* éš±è—æ»¾å‹•æ¢ */
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* æ ¸å¿ƒä¸»é¡Œæ¨£å¼ */
        .theme-simple {
             background-color: #FBF9F2; 
             color: #333; 
        }

        /* ç°¡ç´„æ·ºè‰²å¡ç‰‡ (ç»ç’ƒæ„Ÿ) */
        .glass-light { 
            background: rgba(255, 255, 255, 0.9); 
            backdrop-filter: blur(10px); 
            color: #333;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .card-shadow { box-shadow: 0 4px 25px rgba(0,0,0,0.1); }

        /* å°ˆç”¨æ–¼æ—¥æœŸçš„è¥¯ç·šå­—é«” */
        .date-style { font-family: 'Playfair Display', serif; }
        
        /* è¨­å®šåˆ†å¸³ç³»çµ±ç¶²æ ¼æ•¸ */
        .grid-cols-2 {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }
    </style>
</head>
<body class="bg-[#FBF9F2] text-gray-800 antialiased">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        
        const TRAVELERS = ['Sophie', 'Li'];
        const DEFAULT_RATE = 0.22; // åŒ¯ç‡ä½”ä½ç¬¦
        
        // --- DATA SOURCE & CONFIGS ---

        // äº¤é€šã€ä½å®¿ã€ç·Šæ€¥è³‡è¨Š åŠ é›»å­ç¥¨åˆ¸
        const toolsData = {
            flights: [
                { leg: "å»ç¨‹", code: "IT206", time: "12/20 09:00 TPE -> 14:00 NGO", airport: "TPE/NGO" },
                { leg: "å›ç¨‹", code: "MM625", time: "12/28 16:35 NRT -> 20:00 TPE", airport: "NRT T1" }
            ],
            hotels: [
                { 
                    name: "VIA INN åå¤å±‹ç«™å‰æ¤¿ç”º", 
                    dates: "12/20-12/22", 
                    address: "æ„›çŸ¥ç¸£åå¤å±‹å¸‚ä¸­æ‘å€æ¤¿ç”º9-13 (ã€’453-0015)", 
                    phone: "+81-52-451-5489" 
                },
                { 
                    name: "MYSTAYS å¯Œå£«å±±å±•æœ›æ¸©æ³‰é…’åº—", 
                    dates: "12/22-12/24", 
                    address: "å±±æ¢¨ç¸£å¯Œå£«å‰ç”°å¸‚æ–°å€‰2654 (ã€’403-0011)", 
                    phone: "+81-555-21-7510" 
                },
                { 
                    name: "Land About Tokyo", 
                    dates: "12/24-12/28", 
                    address: "æ±äº¬éƒ½å°æ±å€æ ¹å²¸3-4-5 (ã€’110-0003)", 
                    phone: "+81-3-6802-4431" 
                }
            ],
            emergency: [
                { name: "æ—…å¤–åœ‹äººæ€¥é›£æ•‘åŠ©", phone: "+81-3-3280-7717" },
                { name: "å ±è­¦", phone: "110" },
                { name: "æ•‘è­·è»Š", phone: "119" }
            ],
            // é›»å­ç¥¨åˆ¸/QR Code å€åŸŸ (è«‹è‡ªè¡Œæ›¿æ›ç‚ºæ‚¨çš„å¯¦éš›é€£çµ)
            tickets: [
                { 
                    name: "Shibuya Sky å±•æœ›å°é–€ç¥¨", 
                    date: "12/25", 
                    type: "QR Code/PDF", 
                    link: "https://example.com/shibuya_sky_qr_pdf" // æ›¿æ›æˆæ‚¨çš„ PDF æˆ–ç™»å…¥é€£çµ
                },
                { 
                    name: "å¯Œå£«æ€¥æ¨‚åœ’é€šç¥¨", 
                    date: "12/23", 
                    type: "Barcode/Link", 
                    link: "https://example.com/fujiq_highland_e_ticket" // æ›¿æ›æˆæ‚¨çš„ç¥¨åˆ¸é€£çµ
                },
                {
                    name: "Harbs è›‹ç³•å…Œæ›åˆ¸", 
                    date: "12/20", 
                    type: "Image",
                    // å‡è¨­é€™æ˜¯æ‚¨ä¸Šå‚³æˆ–å„²å­˜åœ¨ç¶²è·¯ä¸Šçš„ QR code åœ–ç‰‡é€£çµ
                    link: "https://via.placeholder.com/150/0000FF/FFFFFF?text=Harbs+QR" 
                }
            ]
        };

        const THEME_COLOR = 'bg-[#FBF9F2]'; 
        const themeConfig = {
            city: { isDark: false, url: null, fallbackColor: THEME_COLOR },
            history: { isDark: false, url: null, fallbackColor: THEME_COLOR },
            travel: { isDark: false, url: null, fallbackColor: THEME_COLOR },
            amusement: { isDark: false, url: null, fallbackColor: THEME_COLOR },
            fuji_christmas: { isDark: false, url: null, fallbackColor: THEME_COLOR },
            shibuya_modern: { isDark: false, url: null, fallbackColor: THEME_COLOR },
            traditional_sky: { isDark: false, url: null, fallbackColor: THEME_COLOR },
            shopping: { isDark: false, url: null, fallbackColor: THEME_COLOR },
            home: { isDark: false, url: null, fallbackColor: THEME_COLOR },
            default: { isDark: false, url: null, fallbackColor: THEME_COLOR }
        };

        const getBackgroundStyle = (theme) => {
            const config = themeConfig[theme] || themeConfig.default;
            return {
                className: `theme-simple ${config.fallbackColor} transition-colors duration-500`,
                style: { backgroundColor: '#FBF9F2' },
                isDark: config.isDark 
            };
        };

        const tripData = [
            // Day 1
            {
                day: 1, date: "12/20 (Sat)", location: "Nagoya", weather: "sunny",
                temperature: [8, 10, 12, 14, 13, 11, 9, 8], 
                temp_hour_range: "10:00 - 18:00",
                daily_pass: "åéµå–®ç¨‹ç¥¨ (æ©Ÿå ´åˆ°é£¯åº—) + åå¤å±‹åœ°éµé€±æœ«ç’°ä¿ç¥¨ (Donichi Eco Kippu, 600 JPY)",
                memo: "Day 1 å‚™è¨»ï¼šè«‹ç¢ºä¿åéµç‰¹æ€¥è»Šç¥¨å·²è³¼è²·ã€‚**å‰›åˆ°æ—¥æœ¬å…ˆæ›å¥½ç¶²å¡ã€‚**", // ç¤ºç¯„å‚™è¨»
                events: [
                    { time: "09:00", title: "æ¡ƒåœ’ (TPE) âœˆï¸ åå¤å±‹ (NGO)", type: "transport", transport_note: "è™èˆª IT206 (è«‹è‡ªè¡Œç¢ºèªç™»æ©Ÿæ™‚é–“)", event_note: "Check-in & å‡ºå¢ƒ | D1 ç­æ©Ÿè³‡è¨Š", link: "" },
                    { time: "14:00", title: "æŠµé”åå¤å±‹ NGO & å‰å¾€é£¯åº—", type: "transport", transport_note: "åéµç‰¹æ€¥ | å»ºè­°é ç•™ 1.5hr", event_note: "æ–¼ä¸­éƒ¨åœ‹éš›æ©Ÿå ´è³¼è²·åéµç‰¹æ€¥è»Šç¥¨", link: "" },
                    { time: "15:30", title: "VIA INN åå¤å±‹ç«™å‰æ¤¿ç”º Check-in", type: "accommodation", event_note: "æ—…é¤¨ Check-in å®Œå¾Œï¼Œå…ˆåœ¨é™„è¿‘ç†Ÿæ‚‰ç’°å¢ƒ", link: toolsData.hotels[0].address },
                    { time: "17:00", title: "HARBS ç”œé»ï¼ˆå¤§é ç™¾åå¤å±‹åº—ï¼‰", type: "food", event_note: "ä½¿ç”¨å…Œæ›åˆ¸ | åœ°é»åœ¨åå¤å±‹è»Šç«™é™„è¿‘", link: "" },
                    { time: "19:30", title: "æ™šé¤ï¼šé°»é­šé£¯ï¼ˆã¾ã‚‹ã‚„æœ¬åº—ï¼‰", type: "food", event_note: "ã²ã¤ã¾ã¶ã— (æ«ƒã¾ã¶ã—) | å¿…é»", link: "" },
                    { time: "21:00", title: "åå¤å±‹ç«™å‘¨é‚Šæ¢ç´¢æˆ–å›é£¯åº—ä¼‘æ¯", type: "leisure", event_note: "è¦–é«”åŠ›æ±ºå®šï¼Œå¯é€› BIC CAMERA", link: "" }
                ]
            },
            // Day 2
            {
                day: 2, date: "12/21 (Sun)", location: "Nagoya", weather: "cloudy",
                temperature: [7, 8, 10, 11, 10, 9, 8, 7], 
                temp_hour_range: "09:00 - 17:00",
                daily_pass: "åå¤å±‹åœ°éµé€±æœ«ç’°ä¿ç¥¨ (Donichi Eco Kippu, 600 JPY)",
                memo: "Day 2 å‚™è¨»ï¼šä»Šå¤©å¤šåˆ©ç”¨åœ°éµä¸€æ—¥åˆ¸ã€‚ç†±ç”°ç¥å®®è¡Œç¨‹çµæŸå¾Œï¼Œå¯ä»¥è€ƒæ…®åœ¨é™„è¿‘åƒåˆé¤ã€‚",
                events: [
                    { time: "08:30", title: "ç†±ç”°ç¥å®®", type: "sight", suggested_departure: "08:20", transport_note: "åéµ (åå¤å±‹ç«™ -> ç¥å®®å‰ç«™)", event_note: "æ—¥æœ¬ä¸‰å¤§ç¥å®®ä¹‹ä¸€ï¼Œç¥ˆç¦æ±‚ç±¤", link: "" },
                    { time: "11:00", title: "åå¤å±‹åŸ", type: "sight", suggested_departure: "10:40", transport_note: "åœ°éµ | å¸‚å½¹æ‰€ç«™", event_note: "å¿…çœ‹é‡‘é¯±ï¼æ³¨æ„é—œé–€æ™‚é–“ (16:30)", link: "" },
                    { time: "13:30", title: "åˆé¤ï¼šåå¤å±‹ç‰¹è‰²æ–™ç†", type: "food", event_note: "å‘³å™Œè±¬æ’æˆ–æ‰‹ç¾½å…ˆï¼ˆé›ç¿…ï¼‰æ“‡ä¸€", link: "" },
                    { time: "15:30", title: "å¤§é ˆè§€éŸ³å¯º & å¤§é ˆå•†åº—è¡—", type: "shopping", transport_note: "åœ°éµ | å¤§é ˆè§€éŸ³ç«™", event_note: "é€›è¡—è³¼ç‰©ï¼Œå°‹æ‰¾é›¶é£Ÿæˆ–ç´€å¿µå“", link: "" },
                    { time: "19:30", title: "æ™šé¤ï¼šå±…é…’å±‹æˆ–ç‡’è‚‰", type: "food", event_note: "é«”é©—æ—¥å¼å±…é…’å±‹æ–‡åŒ–", link: "" },
                    { time: "21:00", title: "è¿”å›é£¯åº—ä¼‘æ¯", type: "leisure", event_note: "", link: "" }
                ]
            },
            // Day 3
            {
                day: 3, date: "12/22 (Mon)", location: "Fuji", weather: "rain",
                temperature: [5, 7, 9, 10, 8, 7, 6, 5], 
                temp_hour_range: "08:00 - 16:00",
                daily_pass: "JR é«˜é€Ÿå·´å£« (åå¤å±‹ -> å¯Œå£«æ€¥æ¨‚åœ’)",
                memo: "Day 3 å‚™è¨»ï¼šä¸»è¦äº¤é€šæ—¥ï¼Œè¡Œææº–å‚™å¥½ã€‚å¾åå¤å±‹æ­é«˜é€Ÿå·´å£«ç›´é”å¯Œå£«å±±ï¼Œæ™‚é–“è¼ƒé•·ï¼Œéœ€æº–å‚™å¨›æ¨‚ã€‚",
                events: [
                    { time: "08:00", title: "Check-out & åå¤å±‹ç«™", type: "accommodation", event_note: "å°‡å¤§ä»¶è¡Œæå¯„é€åˆ°æ±äº¬ Land About Tokyo (é»‘è²“å®…æ€¥ä¾¿)", link: "" },
                    { time: "09:30", title: "é«˜é€Ÿå·´å£«ï¼šåå¤å±‹ -> å¯Œå£«æ€¥æ¨‚åœ’", type: "transport", transport_note: "JR æ±æµ·é«˜é€Ÿå·´å£« | è»Šç¨‹ç´„ 4.5hrã€‚è«‹ææ—©åˆ°è»Šç«™å€™è»Šä¸¦ç¢ºèªä¹˜è»Šä½ç½®ã€‚", event_note: "åéµå·´å£«ç¸½ç«™å‡ºç™¼ï¼Œéœ€äº‹å…ˆåŠƒä½ã€‚å¸¶é»é›¶é£Ÿå’Œæ°´ã€‚", link: "" },
                    { time: "14:00", title: "æŠµé”å¯Œå£«æ€¥æ¨‚åœ’ç«™", type: "transport", event_note: "è½‰ä¹˜å¯Œå£«æ€¥è¡Œç·šæˆ–è¨ˆç¨‹è»Šè‡³é£¯åº—", link: "" },
                    { time: "15:00", title: "MYSTAYS å¯Œå£«å±±å±•æœ›æº«æ³‰é…’åº— Check-in", type: "accommodation", event_note: "ç¢ºèªæˆ¿é–“çš„å¯Œå£«å±±æ™¯è§€ï¼", link: toolsData.hotels[1].address },
                    { time: "17:00", title: "æ–°å€‰å¯Œå£«æ·ºé–“ç¥ç¤¾", type: "sight", event_note: "è‹¥å¤©æ°£è¨±å¯ï¼Œå‰å¾€æ‹æ”å¿ éˆå¡”èˆ‡å¯Œå£«å±±åˆå½± (éœ€çˆ¬éšæ¢¯)", link: "" },
                    { time: "19:30", title: "æ™šé¤ï¼šé£¯åº—é™„è¿‘æˆ–æ²³å£æ¹–å‘¨é‚Šé¤å»³", type: "food", event_note: "å»ºè­°åœ¨é£¯åº—é™„è¿‘è§£æ±ºï¼Œæˆ–ç¢ºèªæ²³å£æ¹–å‘¨é‚Šå…¬è»ŠåŠç‡Ÿæ¥­æ™‚é–“", link: "" },
                    { time: "21:00", title: "é«”é©—é£¯åº—æº«æ³‰", type: "leisure", event_note: "æ¬£è³å¤œæ™¯æˆ–å¯Œå£«å±±æ˜Ÿç©º (è‹¥æœ‰)", link: "" }
                ]
            },
            // Day 4-9 (Placeholder data for demonstration)
            { day: 4, date: "12/23 (Tue)", location: "Fuji-Q Highland", weather: "sunny", temperature: [2, 5, 8, 10, 9, 7, 5, 3], temp_hour_range: "09:00 - 17:00", daily_pass: "å¯Œå£«æ€¥æ¨‚åœ’é€šç¥¨", memo: "è«‹å‚™å¦¥é˜²å¯’è¡£ç‰©ã€‚", events: [] },
            { day: 5, date: "12/24 (Wed)", location: "Tokyo Shinjuku", weather: "cloudy", temperature: [6, 8, 11, 13, 12, 10, 8, 7], temp_hour_range: "10:00 - 18:00", daily_pass: "JR å¯Œå£«å±±/æ±äº¬é€šç¥¨", memo: "å¾æ²³å£æ¹–å‰å¾€æ±äº¬ï¼Œæ­ä¹˜ JRã€‚", events: [] },
            { day: 6, date: "12/25 (Thu)", location: "Tokyo Shibuya", weather: "sunny", temperature: [7, 9, 12, 14, 13, 11, 9, 8], temp_hour_range: "11:00 - 19:00", daily_pass: "æ±äº¬åœ°éµä¸€æ—¥åˆ¸", memo: "ä½¿ç”¨ Shibuya Sky é–€ç¥¨ã€‚", events: [] },
            { day: 7, date: "12/26 (Fri)", location: "Tokyo Ueno & Asakusa", weather: "cloudy", temperature: [8, 10, 12, 13, 12, 11, 10, 9], temp_hour_range: "10:00 - 18:00", daily_pass: "æ±äº¬åœ°éµä¸€æ—¥åˆ¸", memo: "ä¸Šé‡å…¬åœ’ã€ç¾è¡“é¤¨ã€æ·ºè‰å¯ºã€‚", events: [] },
            { day: 8, date: "12/27 (Sat)", location: "Tokyo Akihabara & Ginza", weather: "sunny", temperature: [7, 9, 11, 13, 12, 10, 8, 7], temp_hour_range: "10:00 - 18:00", daily_pass: "Suica/Pasmo å¡", memo: "æœ€å¾Œæ¡è³¼æ—¥ã€‚", events: [] },
            { day: 9, date: "12/28 (Sun)", location: "Departure", weather: "cloudy", temperature: [6, 8, 10, 11, 10, 9, 8, 7], temp_hour_range: "09:00 - 17:00", daily_pass: "äº¬æˆé›»éµ (é£¯åº— -> æˆç”°æ©Ÿå ´)", memo: "ææ—© 3 å°æ™‚æŠµé” NRT æ©Ÿå ´ã€‚", events: [
                { time: "12:00", title: "Check-out & å‰å¾€ NRT æ©Ÿå ´", type: "transport", transport_note: "äº¬æˆé›»éµ Access Express æˆ– Skyliner", event_note: "ç¢ºèªé€€æˆ¿æ‰‹çºŒ", link: "" },
                { time: "13:35", title: "NRT T1 Check-in", type: "transport", event_note: "æ¨‚æ¡ƒ MM625", link: "" },
                { time: "16:35", title: "æˆç”° (NRT) âœˆï¸ æ¡ƒåœ’ (TPE)", type: "transport", event_note: "å›ç¨‹ç­æ©Ÿè³‡è¨Š", link: "" }
            ] }
        ];

        // --- ICON UTILITIES ---

        // 1. å¤©æ°£ Icon è½‰æ›å™¨
        const getWeatherIcon = (weather) => {
            switch (weather.toLowerCase()) {
                case 'sunny': return 'â˜€ï¸'; // æ™´å¤©
                case 'cloudy': return 'â˜ï¸'; // é™°å¤©
                case 'rain': return 'ğŸŒ§ï¸';  // é›¨å¤©
                case 'thunderstorm': return 'â›ˆï¸'; // é›·é›¨
                case 'snow': return 'â„ï¸';   // é›ª
                default: return 'ğŸŒ¤ï¸';      // å¤šé›²/æœªçŸ¥
            }
        };

        // 2. äº‹ä»¶ Icon è½‰æ›å™¨
        const getEventIcon = (type) => {
            switch (type) {
                case 'food': return 'ğŸ½ï¸';
                case 'sight': return 'ğŸ¯';
                case 'shopping': return 'ğŸ›ï¸';
                case 'transport': return 'ğŸš„';
                case 'accommodation': return 'ğŸ¨';
                case 'leisure': return 'â˜•';
                default: return 'ğŸ“';
            }
        };

        // --- COMPONENTS ---

        // æº«åº¦/å¤©æ°£é å ±åœ–è¡¨ (å·²æ•´åˆ Icon åŠå°æ™‚é å ±)
        const TemperatureChart = ({ temperatures, tempRange, weather }) => {
            if (!temperatures || temperatures.length === 0) return null;

            // å‡è¨­æ¯å°æ™‚é å ±å¾ tempRange çš„èµ·å§‹æ™‚é–“é–‹å§‹ï¼ŒæŒçºŒ `temperatures.length` å°æ™‚
            const [startHourStr] = tempRange.split(' - ')[0].split(':');
            const startHour = parseInt(startHourStr, 10);
            const hours = temperatures.map((_, index) => {
                const hour = (startHour + index) % 24;
                return `${hour < 10 ? '0' : ''}${hour}:00`;
            });
            
            // æ‰¾å‡ºæœ€é«˜æº«å’Œæœ€ä½æº«åŠå…¶ç´¢å¼•
            const maxTemp = Math.max(...temperatures);
            const minTemp = Math.min(...temperatures);
            const dailyIcon = getWeatherIcon(weather);

            return (
                <div className="p-4 bg-white/70 rounded-2xl shadow-inner mb-6 glass-light">
                    {/* é ‚éƒ¨æº«åº¦ç¯„åœå’Œæ•´é«”å¤©æ°£ */}
                    <div className="flex justify-between items-center mb-4 border-b pb-2 border-gray-100">
                        <span className="text-sm font-medium text-gray-700 flex items-center">
                            <span className="text-lg mr-2">{dailyIcon}</span> 
                            ä»Šæ—¥æº«åº¦è®ŠåŒ– ({tempRange})
                        </span>
                        <span className="text-sm font-semibold">
                            <span className="text-red-600">â†‘{maxTemp}Â°C</span> / <span className="text-blue-600">â†“{minTemp}Â°C</span>
                        </span>
                    </div>

                    {/* å°æ™‚é å ±ç¶²æ ¼ */}
                    <div className="flex justify-between overflow-x-auto hide-scrollbar">
                        {hours.map((hour, index) => {
                            const temp = temperatures[index];
                            const isMax = temp === maxTemp;
                            const isMin = temp === minTemp;

                            return (
                                <div key={index} className="flex flex-col items-center flex-shrink-0 mx-2 sm:mx-0" style={{ width: '12%' }}>
                                    {/* å¤©æ°£ Icon (æš«ç”¨æ¯æ—¥ä¸»è¦å¤©æ°£ Icon) */}
                                    <div className="text-2xl mb-1 opacity-80">{dailyIcon}</div> 
                                    
                                    {/* æº«åº¦å€¼ */}
                                    <div className={`text-sm font-semibold ${
                                        isMax ? 'text-red-600' : 
                                        isMin ? 'text-blue-600' : 
                                        'text-gray-700'
                                    }`}>
                                        {temp}Â°
                                    </div>
                                    
                                    {/* æ™‚é–“æ¨™ç±¤ */}
                                    <div className="text-xs text-gray-500 mt-1">{hour.replace(':00', '')}</div>
                                </div>
                            );
                        })}
                    </div>
                </div>
            );
        };
        
        // å–®ä¸€è¡Œç¨‹å¡ç‰‡
        const TripCard = ({ event, index }) => {
            const cardClass = index % 2 === 0 ? 'bg-white' : 'bg-gray-50';
            
            // JSX è¨»é‡‹å¿…é ˆåœ¨ return ä¹‹å¤–æˆ–æ¨™ç±¤å…§éƒ¨
            const cardInnerClass = 'rounded-2xl overflow-hidden mb-12 mx-4';
            
            return (
                <div className={`glass-light card-shadow ${cardInnerClass}`}>
                    <div className="p-4">
                        <div className="flex justify-between items-start">
                            {/* å·¦å´æ™‚é–“èˆ‡ä¸»è¦è³‡è¨Š */}
                            <div className="flex-1 min-w-0">
                                <p className="text-2xl font-bold text-indigo-700 date-style">{event.time}</p>
                                <h3 className="text-lg font-semibold text-gray-800 mt-1 flex items-center">
                                    <span className="mr-2 text-2xl">{getEventIcon(event.type)}</span>
                                    {event.title}
                                </h3>
                                
                                {/* å‚™è¨»/èªªæ˜ */}
                                {(event.event_note || event.transport_note) && (
                                    <div className="mt-2 text-sm text-gray-600 space-y-1">
                                        {event.event_note && <p>ğŸ—’ï¸ {event.event_note}</p>}
                                        {event.transport_note && <p>ğŸš„ {event.transport_note}</p>}
                                    </div>
                                )}
                                
                                {/* å»ºè­°å‡ºç™¼æ™‚é–“ */}
                                {event.suggested_departure && (
                                    <p className="text-xs text-gray-500 mt-2">
                                        å»ºè­°å‡ºç™¼æ™‚é–“: {event.suggested_departure}
                                    </p>
                                )}
                            </div>
                            
                            {/* å³å´é€£çµ (è‹¥æœ‰) */}
                            {event.link && (
                                <a href={event.link} target="_blank" className="ml-4 flex-shrink-0 text-sm font-medium text-indigo-500 hover:text-indigo-600 transition duration-150">
                                    æŸ¥çœ‹åœ°åœ– &rarr;
                                </a>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // æ¯æ—¥è¡Œç¨‹ç¸½è¦½
        const DailyItinerary = ({ dayData, isDark }) => {
            const textColor = isDark ? 'text-white' : 'text-gray-800';
            const subTextColor = isDark ? 'text-gray-300' : 'text-gray-600';
            const iconColor = isDark ? 'text-yellow-300' : 'text-indigo-700';

            const maxTemp = Math.max(...(dayData.temperature || []));
            const minTemp = Math.min(...(dayData.temperature || []));
            const dailyIcon = getWeatherIcon(dayData.weather);

            return (
                <main className="min-h-screen pb-16">
                    {/* é ‚éƒ¨æ—¥æœŸèˆ‡åŸå¸‚è³‡è¨Š */}
                    <header className="px-4 pt-8 pb-4">
                        <h1 className={`text-4xl font-bold ${textColor} date-style mb-2`}>
                            DAY {dayData.day}
                        </h1>
                        <h2 className={`text-xl font-medium ${subTextColor}`}>
                            {dayData.date} | {dayData.location}
                        </h2>
                        
                        {/* æ¯æ—¥æ°£æº«é¡¯ç¤º */}
                        <div className={`mt-3 flex items-center text-lg font-semibold ${textColor}`}>
                             <span className={`text-3xl mr-2 ${iconColor}`}>{dailyIcon}</span>
                             {dayData.weather}
                             <span className="ml-4 text-red-500">â†‘{maxTemp}Â°</span> 
                             <span className="ml-2 text-blue-500">â†“{minTemp}Â°</span>
                        </div>
                    </header>

                    {/* äº¤é€šç¥¨åˆ¸æç¤º */}
                    {dayData.daily_pass && (
                         <div className="mx-4 mb-6 p-3 bg-indigo-50 rounded-xl shadow-md border border-indigo-200">
                             <p className="text-sm font-semibold text-indigo-700 flex items-center">
                                 <span className="text-lg mr-2">ğŸ«</span>
                                 å»ºè­°äº¤é€šå¥—ç¥¨:
                             </p>
                             <p className="mt-1 text-sm text-indigo-600">{dayData.daily_pass}</p>
                         </div>
                    )}

                    {/* æº«åº¦é å ±åœ–è¡¨ */}
                    <div className="px-4">
                        <TemperatureChart 
                            temperatures={dayData.temperature} 
                            tempRange={dayData.temp_hour_range}
                            weather={dayData.weather}
                        />
                    </div>

                    {/* æ¯æ—¥å‚™è¨» */}
                    {dayData.memo && (
                        <div className="mx-4 mb-6 p-3 bg-yellow-50 rounded-xl shadow-md border border-yellow-200">
                            <p className="text-sm font-semibold text-yellow-700 flex items-center">
                                <span className="text-lg mr-2">ğŸ””</span>
                                æ¯æ—¥æé†’:
                            </p>
                            <p className="mt-1 text-sm text-yellow-600">{dayData.memo}</p>
                        </div>
                    )}

                    {/* è¡Œç¨‹åˆ—è¡¨ */}
                    <section className="space-y-4">
                        {dayData.events.map((event, index) => (
                            <TripCard key={index} event={event} index={index} />
                        ))}
                    </section>
                </main>
            );
        };

        // --- MAIN APP ---

        const App = () => {
            const [activeDayIndex, setActiveDayIndex] = useState(0); // é è¨­é¡¯ç¤º Day 1
            const [activeTab, setActiveTab] = useState('itinerary');
            
            const totalDays = tripData.length;
            const currentDayData = tripData[activeDayIndex];
            
            const backgroundConfig = getBackgroundStyle(currentDayData.theme);
            const isDark = backgroundConfig.isDark;

            // è™•ç†æ—¥æœŸåˆ‡æ›
            const nextDay = () => setActiveDayIndex((prev) => Math.min(prev + 1, totalDays - 1));
            const prevDay = () => setActiveDayIndex((prev) => Math.max(prev - 1, 0));

            // æ¸²æŸ“å·¥å…·é é¢
            const renderTools = () => {
                const renderSection = (title, data, renderItem) => (
                    <div className="mb-8 glass-light card-shadow rounded-2xl p-4">
                        <h3 className="text-xl font-bold mb-3 text-indigo-700 border-b pb-2">{title}</h3>
                        <div className="space-y-3">
                            {data.map(renderItem)}
                        </div>
                    </div>
                );

                const renderFlight = (item, index) => (
                    <div key={index} className="text-sm p-2 border-l-4 border-indigo-400 pl-3 bg-gray-50 rounded-md">
                        <p className="font-semibold">{item.leg} ({item.code})</p>
                        <p className="text-gray-600">{item.time}</p>
                        <p className="text-xs text-gray-500">æ©Ÿå ´: {item.airport}</p>
                    </div>
                );

                const renderHotel = (item, index) => (
                    <div key={index} className="text-sm p-2 border-l-4 border-green-400 pl-3 bg-gray-50 rounded-md">
                        <p className="font-semibold text-green-700">{item.name}</p>
                        <p className="text-gray-700">å…¥ä½æ—¥æœŸ: {item.dates}</p>
                        <p className="text-gray-600">åœ°å€: {item.address}</p>
                        <p className="text-xs text-gray-500">é›»è©±: {item.phone}</p>
                    </div>
                );

                const renderTicket = (item, index) => (
                    <div key={index} className="text-sm p-2 border-l-4 border-red-400 pl-3 bg-gray-50 rounded-md">
                        <p className="font-semibold text-red-700">{item.name}</p>
                        <p className="text-gray-700">ä½¿ç”¨æ—¥æœŸ: {item.date}</p>
                        <p className="text-gray-600">é¡å‹: {item.type}</p>
                        <a href={item.link} target="_blank" className="text-xs text-red-500 hover:underline">
                            é»æ“ŠæŸ¥çœ‹ç¥¨åˆ¸/QR Code &rarr;
                        </a>
                    </div>
                );

                return (
                    <div className="p-4 pt-8">
                        {renderSection("èˆªç­è³‡è¨Š", toolsData.flights, renderFlight)}
                        {renderSection("ä½å®¿è³‡è¨Š", toolsData.hotels, renderHotel)}
                        {renderSection("é›»å­ç¥¨åˆ¸/QR Codes", toolsData.tickets, renderTicket)}
                        {renderSection("ç·Šæ€¥é€£çµ¡è³‡è¨Š", toolsData.emergency, (item, index) => (
                            <div key={index} className="text-sm p-2 border-l-4 border-orange-400 pl-3 bg-gray-50 rounded-md">
                                <p className="font-semibold">{item.name}</p>
                                <a href={`tel:${item.phone}`} className="text-orange-600 hover:underline">{item.phone}</a>
                            </div>
                        ))}
                    </div>
                );
            };

            // æ¸²æŸ“åˆ†å¸³å·¥å…·
            const renderSplit = () => {
                return (
                    <div className="p-4 pt-8">
                        <div className="mb-8 glass-light card-shadow rounded-2xl p-4">
                            <h3 className="text-xl font-bold mb-3 text-indigo-700 border-b pb-2">åˆ†å¸³å·¥å…· (è²»ç”¨è¿½è¹¤)</h3>
                            <p className="text-sm text-gray-600 mb-4">æ­¤è™•ç‚ºåˆ†å¸³åŠŸèƒ½è¨­è¨ˆé ç•™ä½ç½®ã€‚å¯æ•´åˆå¤–éƒ¨ App æˆ–è‡ªè¡ŒåŠ å…¥è¡¨æ ¼ã€‚</p>
                            
                            {/* åŒ¯ç‡è³‡è¨Š */}
                            <div className="text-sm bg-blue-50 p-3 rounded-lg mb-4">
                                <p className="font-semibold text-blue-700">ç•¶å‰åƒè€ƒåŒ¯ç‡</p>
                                <p className="text-blue-600">1 JPY â‰ˆ {DEFAULT_RATE} TWD</p>
                            </div>

                            {/* è²»ç”¨é …ç›®ç¤ºç¯„ */}
                            <div className="space-y-2">
                                <h4 className="font-semibold mt-4">è²»ç”¨è¿½è¹¤ç¤ºç¯„</h4>
                                <div className="grid grid-cols-2 gap-4 text-sm font-medium">
                                    <p>é …ç›®</p><p className="text-right">é‡‘é¡ (JPY)</p>
                                    <p className="text-gray-700">Day 1 é°»é­šé£¯</p><p className="text-right text-gray-700">7,500</p>
                                    <p className="text-gray-700">Day 2 åœ°éµåˆ¸</p><p className="text-right text-gray-700">1,200</p>
                                    <p className="font-bold border-t pt-2">ç¸½è¨ˆ (ç¤ºç¯„)</p><p className="font-bold text-right border-t pt-2">8,700</p>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            // æ¸²æŸ“å³æ™‚ç¿»è­¯ (Placeholder)
            const renderTranslate = () => (
                <div className="p-4 pt-8">
                    <div className="mb-8 glass-light card-shadow rounded-2xl p-4">
                        <h3 className="text-xl font-bold mb-3 text-indigo-700 border-b pb-2">å³æ™‚ç¿»è­¯ (Placeholder)</h3>
                        <p className="text-sm text-gray-600">æ­¤è™•å¯åµŒå…¥ Google Translate æˆ– DeepL ç­‰å·¥å…·çš„ Widgetï¼Œæ–¹ä¾¿å³æ™‚æºé€šã€‚</p>
                        <textarea 
                            className="w-full mt-4 p-3 border rounded-lg h-32 text-gray-800 focus:ring-indigo-500 focus:border-indigo-500"
                            placeholder="è¼¸å…¥ä¸­æ–‡æˆ–æ—¥æ–‡é€²è¡Œç¿»è­¯..."
                            disabled
                        ></textarea>
                    </div>
                </div>
            );


            // ä¸»å…§å®¹æ¸²æŸ“
            const renderContent = () => {
                switch (activeTab) {
                    case 'itinerary':
                        return <DailyItinerary dayData={currentDayData} isDark={isDark} />;
                    case 'tools':
                        return renderTools();
                    case 'split':
                        return renderSplit();
                    case 'translate':
                        return renderTranslate();
                    default:
                        return <DailyItinerary dayData={currentDayData} isDark={isDark} />;
                }
            };

            return (
                <div className={`min-h-screen ${backgroundConfig.className}`} style={backgroundConfig.style}>
                    
                    {/* é ‚éƒ¨æ¨™é¡Œ */}
                    <div className="sticky top-0 z-20 bg-white/95 backdrop-blur-sm shadow-md">
                         <header className="flex flex-col items-center pt-4 pb-2">
                            <p className="text-xs text-gray-500 font-medium">SL Japan Travel 2025</p>
                            <h1 className="text-2xl font-bold text-gray-900 mt-1">æ—¥æœ¬æ—…éŠè¡Œç¨‹</h1>
                         </header>

                         {/* Tab å°èˆªåˆ— */}
                         <nav className="flex justify-around border-t border-b border-gray-200">
                             {/* ç°¡åŒ– Tab çµæ§‹ï¼Œç§»é™¤ IconArrowLeft é¿å…éŒ¯èª¤ */}
                             {[
                                 { key: 'itinerary', label: 'æ¯æ—¥è¡Œç¨‹' },
                                 { key: 'tools', label: 'æ©Ÿç¥¨/ä½å®¿' },
                                 { key: 'split', label: 'åˆ†å¸³å·¥å…·' },
                                 { key: 'translate', label: 'å³æ™‚ç¿»è­¯' }
                             ].map(tab => (
                                 <button
                                     key={tab.key}
                                     onClick={() => setActiveTab(tab.key)}
                                     className={`py-3 px-2 text-sm font-medium transition-colors duration-200 ${
                                         activeTab === tab.key
                                             ? 'text-indigo-600 border-b-2 border-indigo-600'
                                             : 'text-gray-500 hover:text-gray-700'
                                     }`}
                                 >
                                     {tab.label}
                                 </button>
                             ))}
                         </nav>
                    </div>

                    {/* ä¸»å…§å®¹å€ */}
                    {renderContent()}

                    {/* åº•éƒ¨å°èˆª (åªåœ¨æ¯æ—¥è¡Œç¨‹ Tab é¡¯ç¤º) */}
                    {activeTab === 'itinerary' && (
                        <div className="fixed bottom-0 left-0 right-0 p-4 bg-white/95 backdrop-blur-md border-t border-gray-200 z-30">
                            <div className="flex justify-between items-center max-w-lg mx-auto">
                                <button 
                                    onClick={prevDay} 
                                    disabled={activeDayIndex === 0}
                                    className={`p-3 rounded-full transition-colors ${activeDayIndex === 0 ? 'bg-gray-100 text-gray-400' : 'bg-indigo-100 text-indigo-600 hover:bg-indigo-200'}`}
                                >
                                    &larr;
                                </button>
                                
                                <span className="text-lg font-bold text-gray-800">
                                    DAY {currentDayData.day} / {totalDays}
                                </span>

                                <button 
                                    onClick={nextDay} 
                                    disabled={activeDayIndex === totalDays - 1}
                                    className={`p-3 rounded-full transition-colors ${activeDayIndex === totalDays - 1 ? 'bg-gray-100 text-gray-400' : 'bg-indigo-100 text-indigo-600 hover:bg-indigo-200'}`}
                                >
                                    &rarr;
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // ä¿®æ­£ React 18 æ¸²æŸ“æ–¹å¼
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
